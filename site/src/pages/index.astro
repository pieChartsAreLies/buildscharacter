---
import Base from '../layouts/Base.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog', ({ data }) => !data.draft))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<Base title="Home">
  <!-- Hero -->
  <section class="py-16 text-center">
    <h1 class="font-display text-5xl font-bold tracking-tight mb-4">
      It Builds Character
    </h1>
    <p class="text-xl text-slate max-w-2xl mx-auto mb-8">
      Celebrating the universal experience of doing hard things.
      Making suffering funny, shareable, and wearable.
    </p>
    <div class="flex gap-4 justify-center">
      <a
        href="/blog"
        class="bg-rust text-offwhite px-6 py-3 font-medium hover:bg-rust/90 transition-colors"
      >
        Read the Blog
      </a>
      <a
        href="/shop"
        class="border border-charcoal px-6 py-3 font-medium hover:bg-charcoal hover:text-offwhite transition-colors"
      >
        Shop Merch
      </a>
    </div>
  </section>

  <!-- Latest Posts -->
  {posts.length > 0 && (
    <section class="py-12">
      <h2 class="font-display text-2xl font-bold mb-8">Latest from the Blog</h2>
      <div class="grid gap-8 md:grid-cols-3">
        {posts.map((post) => (
          <a href={`/blog/${post.id}`} class="group">
            <article class="border border-charcoal/10 p-6 hover:border-rust/40 transition-colors h-full">
              <time class="text-sm text-slate font-mono">
                {post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
              </time>
              <h3 class="font-display font-bold text-lg mt-2 group-hover:text-rust transition-colors">
                {post.data.title}
              </h3>
              <p class="text-slate mt-2 text-sm">
                {post.data.description}
              </p>
            </article>
          </a>
        ))}
      </div>
    </section>
  )}

  <!-- Substack CTA -->
  <section class="py-12 border-t border-charcoal/10">
    <div class="text-center">
      <h2 class="font-display text-2xl font-bold mb-3">Follow the Experiment</h2>
      <p class="text-slate mb-6 max-w-lg mx-auto">
        Hobson publishes a weekly Substack with real numbers, real failures, and the occasional joke that lands.
      </p>
      <a
        href="https://buildscharacter.substack.com"
        class="bg-charcoal text-offwhite px-6 py-3 font-medium hover:bg-charcoal/80 transition-colors inline-block"
      >
        Subscribe on Substack
      </a>
    </div>
  </section>
</Base>
